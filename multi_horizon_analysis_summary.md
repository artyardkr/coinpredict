# 다중 예측 기간 분석 요약 (Multi-Horizon Prediction Analysis)

**생성일**: 2025-10-18
**데이터**: 2021년 BTC 가격 (331개 샘플)
**예측 기간**: 1일, 7일, 30일 후 종가

---

## 📊 주요 결과 (Key Findings)

### 1. 예측 기간별 최고 성능 모델

| 예측 기간 | 최고 모델 | Test R² | Test RMSE | Test MAPE | 특성 수 |
|----------|----------|---------|-----------|-----------|---------|
| **1-day** | XGB_top10 | **0.758** | $3,416 | 4.91% | 10개 |
| **7-day** | RF_top30 | **0.335** | $5,575 | 7.73% | 30개 |
| **30-day** | RF_top10 | **-3.447** | $13,071 | 18.51% | 10개 |

### 2. 성능 하락 추세 (Performance Degradation)

**XGBoost + Top 10 특성 기준 비교:**

```
1일 예측:  R² = 0.758  |  RMSE = $3,417  |  MAPE = 4.91%
7일 예측:  R² = -0.162 |  RMSE = $7,371  |  MAPE = 11.71%
30일 예측: R² = -3.607 |  RMSE = $13,303 |  MAPE = 20.12%
```

**1일 대비 성능 변화율:**

| 지표 | 7일 변화 | 30일 변화 |
|-----|---------|----------|
| R² | **-121.4%** ↓ | **-575.7%** ↓ |
| RMSE | **+115.7%** ↑ | **+289.4%** ↑ |
| MAPE | **+138.4%** ↑ | **+309.6%** ↑ |

---

## 🎯 예측 정확도 분포 (Prediction Accuracy Distribution)

**XGBoost Top 10 기준:**

| 오차 범위 | 1일 예측 | 7일 예측 | 30일 예측 |
|----------|----------|----------|-----------|
| **±1% 이내** | 13.0% | 3.1% | 0.0% |
| **±2% 이내** | 20.0% | 6.1% | 0.0% |
| **±5% 이내** | 52.0% ✓ | 11.2% | 5.5% |
| **±10% 이내** | 92.0% ✓ | 33.7% | 22.0% |

**해석:**
- **1일 예측**: 52%가 ±5% 이내, 실용적 수준
- **7일 예측**: 11.2%만 ±5% 이내, 정확도 크게 하락
- **30일 예측**: 0%가 ±2% 이내, 실용성 없음

---

## 📈 특성 수와 예측 기간의 관계

### 최적 특성 수의 변화

| 예측 기간 | 최적 특성 수 | 최고 R² | 관찰 |
|----------|-------------|---------|------|
| 1일 | **10개** (기술 지표 중심) | 0.758 | 단기 트렌드 포착에 집중 |
| 7일 | **30개** (기술 + 온체인 + 거시) | 0.335 | 다양한 특성 필요 |
| 30일 | **모든 모델 실패** | -3.447 | 특성 수와 무관하게 실패 |

### 관찰 패턴

1. **1일 예측**:
   - Top 10 특성만으로도 높은 성능 (R² 0.758)
   - 더 많은 특성 추가 시 오히려 성능 하락 (과적합)
   - 기술적 지표(EMA, SMA, RSI, OBV 등)가 핵심

2. **7일 예측**:
   - Top 30 특성에서 최고 성능 (R² 0.335)
   - 기술 지표만으로는 부족, 온체인/거시 데이터 필요
   - 여전히 성능은 크게 제한적

3. **30일 예측**:
   - 모든 특성 조합에서 실패 (모든 R² < 0)
   - 더 많은 특성 사용이 오히려 성능 악화
   - 2021년 단일 연도 데이터로는 장기 예측 불가능

---

## 🔬 모델별 비교 (Random Forest vs XGBoost)

### 1-day 예측

| 특성 집합 | RF R² | XGB R² | 우수 모델 |
|----------|-------|--------|----------|
| Top 10 | 0.671 | **0.758** | XGB ✓ |
| Top 20 | 0.667 | 0.565 | RF |
| Top 30 | 0.672 | 0.402 | RF |
| All (84) | 0.658 | 0.603 | XGB |

**관찰**: XGBoost가 Top 10에서 압도적 우세

### 7-day 예측

| 특성 집합 | RF R² | XGB R² | 우수 모델 |
|----------|-------|--------|----------|
| Top 10 | **0.186** | -0.162 | RF ✓ |
| Top 20 | -0.966 | -1.789 | RF |
| Top 30 | **0.335** | -1.053 | RF ✓ |
| All (84) | -0.009 | -0.797 | RF |

**관찰**: RF가 모든 구간에서 우세, XGB는 대부분 음수 R²

### 30-day 예측

| 특성 집합 | RF R² | XGB R² | 우수 모델 |
|----------|-------|--------|----------|
| Top 10 | **-3.447** | -3.607 | RF |
| Top 20 | -5.033 | -5.318 | RF |
| All (84) | -6.058 | -5.867 | XGB |

**관찰**: 둘 다 실패, 하지만 RF가 상대적으로 "덜 나쁨"

---

## 📚 논문 1과의 비교 (Comparison with Paper 1)

### 논문 1의 주요 발견

> "Technical indicators are most important for short-term predictions (1-7 days).
> Traditional markets and macro indicators become more important for longer horizons (90-180 days)."

### 우리 프로젝트 검증 결과

| 논문 1 주장 | 우리 결과 | 검증 여부 |
|-----------|----------|----------|
| 기술 지표는 단기(1-7일) 예측에 중요 | 1일: Top 10(기술 지표) 최고 성능 | ✅ **검증됨** |
| 장기 예측엔 거시/전통시장 중요 | 30일: 모든 특성 조합 실패 | ❌ **검증 실패** |
| 7일 예측은 다양한 특성 필요 | 7일: Top 30(다양한 특성) 최고 | ✅ **검증됨** |
| 장기 예측(90-180일) 가능 | 30일도 실패 (R² < 0) | ❌ **재현 실패** |

### 논문과의 차이점 분석

#### ✅ 일치하는 부분:

1. **1일 예측**: 기술 지표만으로 높은 성능 (우리: R² 0.758 vs 논문: MAPE 4.5%)
2. **7일 예측**: 다양한 특성 필요 (Top 30에서 최고 성능)
3. **예측 난이도 증가**: 기간이 길어질수록 성능 하락

#### ❌ 차이나는 부분:

1. **30일 예측 실패**:
   - 논문: 90-180일도 양수 R² 달성
   - 우리: 30일에서 이미 R² -3.4 (완전 실패)

2. **데이터 기간**:
   - 논문: 4.5년 (2017-2021), 다양한 시장 상황
   - 우리: 1년 (2021), 단일 상승장 위주

3. **타겟 변수**:
   - 논문: Crypto100 지수 (상대적 움직임)
   - 우리: BTC 절대 가격 (절대값 예측의 어려움)

4. **평가 방법**:
   - 논문: 5-fold cross-validation
   - 우리: 7:3 시계열 단일 분할

---

## 💡 핵심 인사이트 (Key Insights)

### 1. 예측 가능한 기간의 한계

```
✅ 1일 예측: 실용 가능 (R² 0.76, MAPE 4.9%)
⚠️ 7일 예측: 제한적 (R² 0.34, MAPE 7.7%)
❌ 30일 예측: 불가능 (R² -3.4, MAPE 18.5%)
```

**결론**: 2021년 단일 연도 데이터로는 1일 예측만 신뢰 가능

### 2. 특성의 역할 변화

- **1일**: 기술 지표(EMA, SMA, RSI)가 지배적
- **7일**: 온체인(bc_miners_revenue) + 기술 지표 조합
- **30일**: 어떤 특성도 유의미한 패턴 포착 못함

### 3. 모델 선택 가이드

- **단기(1일)**: XGBoost + 소수 핵심 특성(10개)
- **중기(7일)**: Random Forest + 중간 특성(30개)
- **장기(30일)**: 현재 모델로는 불가능 → 다른 접근 필요

### 4. 왜 30일 예측이 실패했는가?

#### ① 데이터 부족
- 2021년만 사용 (302개 샘플 중 30일 제외)
- 학습 데이터: 211개 (7개월), 테스트: 91개 (3개월)
- 다양한 시장 사이클 경험 부족

#### ② 타겟 변수의 본질
- 절대 가격 예측은 상대 변화율 예측보다 훨씬 어려움
- BTC의 변동성: 1개월 내 +50% ~ -30% 가능
- 2021년: 상승장 위주 (29K → 69K → 47K)

#### ③ 예측 기간의 비선형성
- 1일 → 7일: 성능 1/2 감소
- 7일 → 30일: 성능 10배 이상 악화
- 장기 예측은 단순히 "어려운 것"이 아니라 "불가능"

#### ④ 외부 충격 (Black Swan Events)
- 30일 내 예측 불가능한 이벤트 발생 가능
  - 규제 발표, 해킹, 거시경제 충격 등
- 2021년 데이터로는 이런 이벤트 학습 불가

---

## 🔮 개선 방향 (Future Improvements)

### 단기 개선 (현재 모델 최적화)

1. **1일 예측 정교화**
   - ✅ 이미 높은 성능 (R² 0.76)
   - Ensemble: XGBoost + Random Forest 조합
   - 하이퍼파라미터 튜닝 (GridSearch)

2. **7일 예측 개선**
   - 현재 R² 0.34 → 0.5+ 목표
   - 특성 엔지니어링: 7일 이동평균, 주간 패턴
   - 외부 데이터: 뉴스 감성, 소셜 미디어 언급

### 중기 개선 (데이터 확장)

3. **다년도 데이터 수집**
   - 2017-2025 전체 기간 (논문 1과 동일)
   - 다양한 시장 사이클 포함:
     - 상승장 (2017, 2021, 2024)
     - 하락장 (2018, 2022)
     - 횡보장 (2019, 2023)

4. **타겟 변수 변경**
   - 절대 가격 → 상대 변화율 (%)
   - 방향 분류 (상승/하락/횡보)
   - Crypto100 지수 (논문 1 방식)

### 장기 개선 (모델 고도화)

5. **시계열 전문 모델**
   - LSTM, GRU (순환 신경망)
   - Transformer (Helformer, 논문 2 방식)
   - Prophet (페이스북 시계열)

6. **외부 데이터 통합**
   - Twitter/Reddit 감성 분석 (실시간)
   - 뉴스 NLP (BERT, GPT)
   - 거래소 주문장 데이터 (Order book)

7. **교차 검증 방식 개선**
   - 7:3 단일 분할 → 5-fold Time Series CV
   - Walk-forward validation
   - Out-of-sample 기간 확대

---

## 📋 결론 (Conclusion)

### ✅ 성공적인 부분

1. **1일 예측 모델 구축**: R² 0.76, MAPE 4.9% (실용 수준)
2. **논문 1 검증**: 기술 지표의 단기 예측 중요성 확인
3. **특성 최적화**: FRA 알고리즘으로 84개 → 10개 특성 선별
4. **다중 기간 비교**: 1/7/30일 성능 체계적 분석

### ⚠️ 한계점

1. **장기 예측 실패**: 30일 예측 불가능 (R² < 0)
2. **데이터 부족**: 2021년 단일 연도만 사용
3. **시장 편향**: 상승장 위주, 다양한 사이클 미포함
4. **외부 이벤트**: 예측 불가능한 충격 반영 못함

### 🎯 최종 권장 사항

**현재 모델 사용 가능 범위:**

| 예측 기간 | 권장 여부 | 모델 | 신뢰도 |
|----------|----------|------|-------|
| **1일** | ✅ **사용 가능** | XGB_top10 | 높음 (R² 0.76) |
| **7일** | ⚠️ **주의하여 사용** | RF_top30 | 낮음 (R² 0.34) |
| **30일** | ❌ **사용 불가** | - | 없음 (R² < 0) |

**실전 적용 시 고려사항:**

1. **1일 예측**만 트레이딩 보조 지표로 활용
2. 7일/30일은 참고만 하고 의사결정에 사용하지 말 것
3. 외부 이벤트(뉴스, 규제) 발생 시 모델 예측 무시
4. 지속적인 재학습 필요 (시장 패턴 변화)

---

**생성 파일:**
- `step13_multi_horizon_prediction.py`: 다중 기간 예측 스크립트
- `model_results_multi_horizon.csv`: 전체 결과 (36개 모델)
- `multi_horizon_prediction_results.png`: 시각화 결과

**총 훈련 모델 수**: 36개 (3 horizons × 6 feature sets × 2 models)
