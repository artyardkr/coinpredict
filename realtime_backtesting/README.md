# 실시간 비트코인 백테스팅 시뮬레이터

실시간으로 비트코인 트레이딩 전략을 백테스팅하고 시각화하는 인터랙티브 대시보드입니다.

## 🎯 주요 기능

### 1. 실시간 데이터 스트리밍
- Yahoo Finance API를 통한 실시간 비트코인 가격 데이터
- 전통 시장 데이터 (S&P 500, NASDAQ, VIX, Gold, US10Y)
- 기술적 지표 자동 계산 (RSI, MACD, Bollinger Bands)

### 2. AI 기반 예측 엔진
- ElasticNet 모델로 다음날 가격 변동 예측
- 특성 자동 추출 및 전처리
- 예측 신뢰도 계산

### 3. 백테스팅 엔진
- **3가지 전략 지원:**
  - `long_only`: 상승 예측시만 매수
  - `long_short`: 상승시 매수, 하락시 공매도
  - `threshold`: 일정 수익률 이상 예측시만 매수

- **거래 시뮬레이션:**
  - 자동 매수/매도/공매도 실행
  - 거래 비용 및 슬리피지 반영
  - 포지션 관리

- **성과 추적:**
  - 실시간 포트폴리오 가치
  - 총 수익률, 샤프 비율, 최대 낙폭
  - 거래 내역 및 승률

### 4. 인터랙티브 대시보드
- 실시간 가격 차트
- 예측 vs 실제 가격 비교
- 포트폴리오 가치 추이
- 거래 내역 테이블
- 성과 지표 대시보드

## 📦 설치

### 1. 패키지 설치
```bash
cd realtime_backtesting
pip install -r requirements.txt
```

### 2. 필요한 패키지
- streamlit: 대시보드 UI
- pandas, numpy: 데이터 처리
- plotly: 인터랙티브 차트
- yfinance: 금융 데이터 수집
- scikit-learn: 머신러닝 모델

## 🚀 실행 방법

### 기본 실행
```bash
streamlit run dashboard.py
```

브라우저가 자동으로 열리며 `http://localhost:8501`에서 대시보드에 접근할 수 있습니다.

### 포트 변경
```bash
streamlit run dashboard.py --server.port 8502
```

## 🎮 사용 방법

### 1. 사이드바에서 설정
- **전략 선택**: long_only / long_short / threshold
- **Threshold 설정**: 매수 기준 수익률 (%)
- **초기 자본**: 시뮬레이션 시작 자본
- **거래 비용**: 거래당 수수료 (%)
- **데이터 기간**: 과거 데이터 로드 기간
- **시뮬레이션 속도**: 일/초 (빠르기 조절)

### 2. 시뮬레이션 시작
- **▶️ 시작**: 백테스팅 시작
- **⏸️ 정지**: 시뮬레이션 일시 정지
- **🔄 초기화**: 처음부터 다시 시작

### 3. 결과 확인
- **가격 차트**: 실제 vs 예측 가격
- **포트폴리오 차트**: 전략 vs Buy-and-Hold 비교
- **거래 내역**: 최근 10개 거래
- **성과 지표**: 수익률, 샤프, MDD, 승률

## 📊 전략 설명

### Long Only
```
예측 수익률 > 0% → 매수
예측 수익률 ≤ 0% → 매도 (현금 보유)
```
- 가장 안전한 전략
- 하락장에서는 현금 보유
- 수익률은 낮지만 안정적

### Long-Short
```
예측 수익률 > 0.5% → 매수
예측 수익률 < -0.5% → 공매도
-0.5% ≤ 예측 ≤ 0.5% → 중립 (청산)
```
- 가장 공격적인 전략
- 하락장에서도 수익 가능
- 높은 수익률, 높은 리스크

### Threshold
```
예측 수익률 > Threshold → 매수
예측 수익률 ≤ Threshold → 매도 (현금 보유)
```
- 확신이 높을 때만 매수
- Threshold를 높이면 거래 빈도 감소
- 추천 값: 1.0% ~ 2.0%

## 📈 성과 지표 설명

### 총 수익률 (Total Return)
```
(최종 자산 / 초기 자본 - 1) × 100
```
전체 기간 동안의 수익률

### 샤프 비율 (Sharpe Ratio)
```
연율화 수익률 / 연율화 변동성
```
- 1.0 이상: 좋음
- 2.0 이상: 매우 좋음
- 3.0 이상: 훌륭함

### 최대 낙폭 (Max Drawdown)
```
최고점 대비 최대 하락 %
```
최악의 손실 구간 (낮을수록 좋음)

### 승률 (Win Rate)
```
(수익 거래 수 / 전체 거래 수) × 100
```
거래 승률 (50% 이상이면 양호)

## 🔧 고급 설정

### config.py 수정
```python
# 거래 비용
TRANSACTION_COST = 0.001  # 0.1%
SHORT_COST = 0.0005  # 0.05%

# 데이터 기간
DATA_LOOKBACK_DAYS = 365  # 1년

# 시뮬레이션 속도
UPDATE_INTERVAL = 60  # 60초
```

## 🧪 테스트

### 개별 모듈 테스트
```bash
# 데이터 수집 테스트
python data_fetcher.py

# 예측 엔진 테스트
python prediction_engine.py

# 백테스팅 엔진 테스트
python backtesting_engine.py
```

## 📂 프로젝트 구조

```
realtime_backtesting/
├── config.py                 # 설정 파일
├── data_fetcher.py           # 데이터 수집 모듈
├── prediction_engine.py      # 예측 엔진
├── backtesting_engine.py     # 백테스팅 엔진
├── dashboard.py              # Streamlit 대시보드
├── requirements.txt          # 패키지 목록
└── README.md                 # 이 파일
```

## 💡 사용 팁

### 1. 전략 비교
여러 전략을 순차적으로 실행하여 비교:
1. long_only (Threshold 0%)
2. threshold (1.0%)
3. threshold (2.0%)
4. long_short

### 2. 최적 Threshold 찾기
0.5%부터 3.0%까지 0.5% 간격으로 테스트:
- 낮은 threshold → 거래 빈도 ↑, 수익률 변동 ↑
- 높은 threshold → 거래 빈도 ↓, 안정성 ↑

### 3. 거래 비용 영향
거래 비용을 0.05%, 0.1%, 0.2%로 변경하여 테스트:
- 빈번한 거래 전략은 거래 비용에 민감

### 4. 데이터 기간
- 30일: 단기 트렌드
- 365일: 중기 트렌드
- 730일: 장기 트렌드

## ⚠️ 주의사항

1. **실제 트레이딩 아님**
   - 이 시뮬레이터는 교육 및 연구 목적입니다
   - 실제 투자 결정에 사용하지 마세요

2. **과거 성과 ≠ 미래 수익**
   - 백테스팅 결과는 과거 데이터 기반입니다
   - 실제 시장에서는 다를 수 있습니다

3. **슬리피지 미반영**
   - 대량 거래시 가격 변동
   - 유동성 부족시 체결 지연

4. **모델 한계**
   - 더미 모델 사용 (랜덤 예측)
   - 실제 V2 모델 연동 필요

## 🔜 향후 개발 계획

- [ ] 실제 V2 ElasticNet 모델 통합
- [ ] 더 많은 전략 추가 (MA Cross, RSI, etc.)
- [ ] 멀티 자산 지원 (ETH, SOL, etc.)
- [ ] 실시간 뉴스 감성 분석
- [ ] 포트폴리오 최적화
- [ ] 알람 기능 (특정 조건 달성시)
- [ ] 결과 내보내기 (CSV, PDF)

## 📞 문의

질문이나 버그 리포트는 이슈로 남겨주세요.

---

**면책 조항**: 이 소프트웨어는 교육 목적으로만 제공됩니다. 실제 투자에 사용하여 발생하는 손실에 대해 책임지지 않습니다.
